version: "3.1"

stories:
# ============================================================================
# 1. HAPPY PATH STORIES - Product Search
# ============================================================================
- story: User searches for product and asks price
  steps:
  - intent: greet
  - action: utter_greet
  - intent: search_product
    entities:
    - product_type: "laptop"
  - action: action_search_products
  - intent: ask_product_price
    entities:
    - product_name: "MacBook Pro"
  - action: action_get_product_price
  - intent: thank_you
  - action: utter_you_are_welcome

- story: User checks product availability
  steps:
  - intent: greet
  - action: utter_greet
  - intent: check_product_availability
    entities:
    - product_name: "iPhone 15"
  - action: action_check_availability
  - intent: affirm
  - action: utter_help_order
  - intent: thank_you
  - action: utter_you_are_welcome

- story: User asks for product details
  steps:
  - intent: search_product
    entities:
    - product_type: "headphones"
  - action: action_search_products
  - intent: ask_product_details
    entities:
    - product_name: "AirPods Pro"
  - action: action_get_product_details
  - intent: thank_you
  - action: utter_you_are_welcome

- story: Generic inquiry then specific search
  steps:
  - intent: greet
  - action: utter_greet
  - intent: ask_product_details
  - action: action_get_product_details
  - intent: search_product
  - action: action_search_products
  - intent: ask_product_details
  - action: action_get_product_details

- story: Quick product search without greeting
  steps:
  - intent: search_product
  - action: action_search_products
  - intent: ask_product_price
  - action: action_get_product_price
  - intent: thank_you
  - action: utter_you_are_welcome

# ============================================================================
# 2. ORDER TRACKING STORIES
# ============================================================================
- story: User tracks order with order number
  steps:
  - intent: greet
  - action: utter_greet
  - intent: track_order
    entities:
    - order_number: "#12345"
  - action: action_track_order
  - intent: thank_you
  - action: utter_you_are_welcome

# Removed: "User tracks order without order number" - conflicts with rule
# track_order is now handled by rule "Always track order"

- story: User wants to cancel order
  steps:
  - intent: cancel_order
    entities:
    - order_number: "0000000032"
  - action: action_cancel_order
  - intent: inform_cancel_reason
  - action: action_cancel_order

# ============================================================================
# 3. FAQ & POLICIES STORIES
# ============================================================================
- story: User asks about shipping policy
  steps:
  - intent: ask_shipping_policy
  - action: action_get_shipping_policy
  - intent: thank_you
  - action: utter_you_are_welcome

- story: User asks about return policy
  steps:
  - intent: ask_return_policy
  - action: action_get_return_policy
  - intent: ask_warranty
  - action: action_get_warranty_policy

- story: User asks about payment methods
  steps:
  - intent: ask_payment_methods
  - action: action_get_payment_methods
  - intent: affirm
  - action: utter_help_order

# ============================================================================
# 4. RECOMMENDATION STORIES
# ============================================================================
- story: User asks for product recommendation
  steps:
  - intent: greet
  - action: utter_greet
  - intent: ask_recommendation
  - action: action_recommend_products
  - intent: ask_product_price
  - action: action_get_product_price
  - intent: thank_you
  - action: utter_you_are_welcome

- story: User compares two products
  steps:
  - intent: compare_products
    entities:
    - product_name: "iPhone 15"
    - product_name: "Samsung S24"
  - action: action_compare_products
  - intent: affirm
  - action: utter_help_order

# ============================================================================
# 5. SUPPORT & FALLBACK STORIES
# ============================================================================
- story: User explicitly asks for human support
  steps:
  - intent: create_support_ticket
  - action: action_create_support_ticket

- story: User asks contact information
  steps:
  - intent: ask_contact_info
  - action: utter_contact_info
  - intent: thank_you
  - action: utter_you_are_welcome

# ============================================================================
# 6. COMPLEX INTERACTIVE STORIES
# ============================================================================
- story: User asks for product details
  steps:
  - intent: greet
  - action: utter_greet
  - intent: search_product
    entities:
    - product_type: "laptop"
  - action: action_search_products
  - intent: ask_product_details
  - action: action_get_product_details
  - intent: ask_product_price
  - action: action_get_product_price

- story: User asks for general product introduction
  steps:
  - intent: greet
  - action: utter_greet
  - intent: ask_product_details
  - action: action_get_product_details
  - intent: search_product
  - action: action_search_products
  - intent: ask_product_price
  - action: action_get_product_price
  - intent: thank_you
  - action: utter_you_are_welcome

- story: Multi-turn product inquiry and purchase
  steps:
  - intent: greet
  - action: utter_greet
  - intent: search_product
  - action: action_search_products
  - intent: ask_product_details
  - action: action_get_product_details
  - intent: ask_sizing_advice
  - action: action_get_sizing_advice
  - intent: ask_styling_advice
  - action: action_get_styling_advice
  - intent: check_product_availability
  - action: action_check_availability

- story: Product search then order tracking
  steps:
  - intent: search_product
  - action: action_search_products
  - intent: ask_product_price
  - action: action_get_product_price
  - intent: track_order
    entities:
    - order_number: "#12345"
  - action: action_track_order
  - intent: thank_you
  - action: utter_you_are_welcome

- story: Sizing and styling consultation
  steps:
  - intent: search_product
  - action: action_search_products
  - intent: ask_sizing_advice
  - action: action_get_sizing_advice
  - intent: ask_styling_advice
  - action: action_get_styling_advice
  - intent: check_discount_logic
  - action: action_check_discount
  - intent: thank_you
  - action: utter_you_are_welcome

- story: Complete shopping journey
  steps:
  - intent: greet
  - action: utter_greet
  - intent: search_product
    entities:
    - product_type: "laptop"
  - action: action_search_products
  - intent: ask_product_details
  - action: action_get_product_details
  - intent: ask_product_price
  - action: action_get_product_price
  - intent: check_product_availability
  - action: action_check_availability
  - intent: ask_shipping_policy
  - action: action_get_shipping_policy
  - intent: thank_you
  - action: utter_you_are_welcome
  - intent: goodbye
  - action: utter_goodbye

- story: User needs help after unsuccessful search
  steps:
  - intent: search_product
  - action: action_search_products
  - intent: create_support_ticket
  - action: action_create_support_ticket

# ============================================================================
# 7. CHITCHAT STORIES
# ============================================================================
- story: Full product consultation - KLTN style
  steps:
  - intent: greet
  - action: utter_greet
  - intent: search_product
  - action: action_search_products
  - intent: ask_sizing_advice
  - action: action_get_sizing_advice
  - intent: ask_styling_advice
  - action: action_get_styling_advice
  - intent: check_discount_logic
  - action: action_check_discount
  - intent: check_product_availability
  - action: action_check_availability
  - intent: thank_you
  - action: utter_you_are_welcome

- story: Order issue then support ticket
  steps:
  - intent: track_order
    entities:
    - order_number: "#99999"
  - action: action_track_order
  - intent: report_order_error
  - action: action_report_order_error
  - intent: affirm
  - action: action_create_support_ticket

- story: Product discovery journey
  steps:
  - intent: ask_product_details
  - action: action_get_product_details
  - intent: search_product
  - action: action_search_products
  - intent: ask_product_details
  - action: action_get_product_details
  - intent: ask_product_price
  - action: action_get_product_price
  - intent: check_product_availability
  - action: action_check_availability

- story: Bot challenge and continue
  steps:
  - intent: bot_challenge
  - action: utter_i_am_bot
  - intent: search_product
  - action: action_search_products

- story: Simple greeting and goodbye
  steps:
  - intent: greet
  - action: utter_greet
  - intent: goodbye
  - action: utter_goodbye

# ============================================================================
# 8. GEMINI AI STORIES - Open-ended Queries
# ============================================================================
- story: Handle open-ended query
  steps:
  - intent: open_ended_query
  - action: action_ask_gemini

- story: Handle style advice request
  steps:
  - intent: ask_advice
  - action: action_ask_gemini_with_history

- story: Handle general fashion question
  steps:
  - intent: ask_general_question
  - action: action_ask_gemini

- story: Open-ended query after product search
  steps:
  - intent: search_product
  - action: action_search_products
  - intent: open_ended_query
  - action: action_ask_gemini

- story: Ask advice with conversation context
  steps:
  - intent: greet
  - action: utter_greet
  - intent: search_product
  - action: action_search_products
  - intent: ask_advice
  - action: action_ask_gemini_with_history
  - intent: thank_you
  - action: utter_you_are_welcome
